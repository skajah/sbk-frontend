(this["webpackJsonpsbk-frontend"]=this["webpackJsonpsbk-frontend"]||[]).push([[0],{105:function(e,t){},107:function(e,t){},114:function(e,t,n){},115:function(e,t,n){},116:function(e,t,n){},124:function(e,t,n){},125:function(e,t,n){},126:function(e,t,n){},127:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n.n(a),s=n(37),c=n.n(s),o=(n(74),n(75),n(76),n(9)),i=n(3),l=n.n(i),u=n(7),d=n(4),p=n(8),h=n(6),f=n(5),m=n(11),j=n(10),b=(n(78),r.a.createContext());b.displayName="UserContext";var x=b,v=n(27),O=n(21),g=n(15),w=n(1);var k=function(e){return function(t){Object(h.a)(a,t);var n=Object(f.a)(a);function a(){return Object(d.a)(this,a),n.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var t=this.props,n=t.alert,a=Object(g.a)(t,["alert"]);return Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(e,Object(o.a)({},a)),n&&Object(w.jsx)("div",{className:"alert alert--"+n.type,children:n.message})]})}}]),a}(r.a.Component)},y=k(function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleTextChange=function(t){var n=t.currentTarget.value;e.props.onTextChange(n)},e.renderInput=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,a=t.className,r=t.clear,s=t.placeholder;return Object(w.jsx)("input",{name:n,type:"text",className:a,value:r?"":void 0,placeholder:s,onChange:e.handleTextChange})},e.renderTextArea=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,a=t.className,r=t.clear,s=t.placeholder;return Object(w.jsx)("textarea",{name:n,type:"text",className:a,value:r?"":void 0,placeholder:s,onChange:e.handleTextChange})},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.type,n=Object(g.a)(e,["type"]);return"textarea"===t?this.renderTextArea(n):this.renderInput(n)}}]),n}(a.Component)),C=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).text="",e.handleSearchTextChange=function(t){e.text=t},e.handleKeywordSearch=function(){e.props.onKeywordSearch(e.text)},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.props.placeholder;return Object(w.jsxs)("div",{className:"input-group",children:[Object(w.jsx)(y,{name:"searchKeyword",placeholder:t,className:"text-box",onTextChange:this.handleSearchTextChange}),Object(w.jsx)("span",{className:"icon icon--medium clickable",onClick:function(){return e.handleKeywordSearch()},children:Object(w.jsx)(O.f,{})})]})}}]),n}(a.Component),_=k(function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).dateRange={start:null,end:null},e.handleStartDate=function(t){var n=t.target.value.replaceAll("-","/");e.dateRange.start=new Date(n),e.handleDateChange()},e.handleEndDate=function(t){var n=t.target.value.replaceAll("-","/");e.dateRange.end=new Date(n),e.handleDateChange()},e.handleDateChange=function(){var t=e.dateRange,n=t.start,a=t.end;n&&a&&"Invalid Date"!==n.toString()&&"Invalid Date"!==a.toString()&&e.props.onDateRange(n,a)},e}return Object(p.a)(n,[{key:"render",value:function(){return Object(w.jsxs)("div",{className:"search-date-range",children:[Object(w.jsx)("span",{className:"label",children:"From"}),Object(w.jsx)("input",{type:"date",name:"start-date",className:"search-date-range__input",onChange:this.handleStartDate}),Object(w.jsx)("span",{className:"label",children:"To"}),Object(w.jsx)("input",{type:"date",name:"start-end",className:"search-date-range__input",onChange:this.handleEndDate})]})}}]),n}(a.Component)),S=function(e){var t=e.options,n=e.onSelect;return Object(w.jsxs)("select",{className:"dropdown-list",children:[Object(w.jsx)("option",{value:""}),t.map((function(e){return Object(w.jsx)("option",{className:"dropdown-list__option",value:e,onClick:function(){return n(e)},children:e},e)}))]})},P=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.items,n=e.selectedItem,a=e.onClick;return Object(w.jsx)("ul",{className:"list-group",children:t.map((function(e){return Object(w.jsx)("li",{className:"list-group__item clickable"+(e===n?" list-group__item--active":""),onClick:function(){return a(e)},children:e},e)}))})}}]),n}(a.Component),N=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={dateRangeError:!1},e.handleDateRange=function(t,n){t>n?e.setState({dateRangeError:!0}):(e.props.onDateRange(t,n),e.setState({dateRangeError:!1}))},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.searchByUsername,n=e.dates,a=e.selectedDate,s=e.onDateSelected,c=e.onPostType,o=this.state.dateRangeError,i=this.context.currentUser;return Object(w.jsxs)("div",{className:"post-search",children:[Object(w.jsx)("p",{style:{fontSize:"2rem",margin:"0 0 1rem"},children:"Filter posts"}),Object(w.jsx)(C,{placeholder:" Enter a username",onKeywordSearch:t}),i&&Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)("p",{children:"Pick a Type"}),Object(w.jsx)(S,{options:["All","Liked Posts","Following"],onSelect:c})]}),Object(w.jsx)("p",{children:"Pick a Date"}),Object(w.jsx)(P,{items:n,selectedItem:a,onClick:s}),Object(w.jsx)(_,{onDateRange:this.handleDateRange,alert:o&&{type:"primary",message:"End date can't be before start date"}})]})}}]),n}(a.Component);N.contextType=x;var D=N,U=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"renderImage",value:function(e,t){return Object(w.jsx)("img",{src:e,alt:t,className:"media"})}},{key:"renderVideo",value:function(e,t){return Object(w.jsx)("video",{src:e,controls:!0,alt:t,className:"media"})}},{key:"renderAudio",value:function(e,t){return Object(w.jsx)("audio",{src:e,controls:!0,alt:t,className:"media"})}},{key:"renderMedia",value:function(e,t,n){var a=null;switch(e){case"image":case"gif":a=this.renderImage(t,n);break;case"video":a=this.renderVideo(t,n);break;case"audio":a=this.renderAudio(t,n)}return a}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.src,a=e.alt;return this.renderMedia(t,n,a)}}]),n}(a.Component),F=n(65);var M=function(e){return function(t){Object(h.a)(a,t);var n=Object(f.a)(a);function a(){return Object(d.a)(this,a),n.apply(this,arguments)}return Object(p.a)(a,[{key:"render",value:function(){var t=this.props,n=t.extensions,a=t.maxFileSize,r=t.onFileChosen,s=Object(g.a)(t,["extensions","maxFileSize","onFileChosen"]);return Object(w.jsx)("div",{className:"file-chooser",children:Object(w.jsx)(F.FilePicker,{extensions:n,maxSize:a,onChange:function(e){return r(e)},onError:function(e){return alert(e)},children:Object(w.jsx)(e,Object(o.a)({},s))})})}}]),a}(r.a.Component)};var L=M((function(e){return Object(w.jsx)("span",{className:"file-icon clickable",onClick:e.onClick,children:e.children})})),T=(n(80),["outline","rounded","block","corner"]),E=["small","medium","large"],A=["primary","secondary","accent"];var I=function(e){return e?e.filter((function(e){return T.includes(e)})).map((function(e){return"btn--"+e})).join(" "):""},R=function(e){return E.includes(e)?"btn--"+e:""},z=function(e){return"btn--".concat(A.includes(e)?e:"")},B=function(e){var t=e.children,n=e.styles,a=e.color,r=e.size,s=e.onClick,c=Object(g.a)(e,["children","styles","color","size","onClick"]);return Object(w.jsx)("button",Object(o.a)(Object(o.a)({className:"btn ".concat(I(n)," ").concat(R(r)," ").concat(z(a)),onClick:s},c),{},{children:t}))},W=n(42),J=n(66),K=(n(81),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={media:null},e.text="",e.handleTextChange=function(t){e.text=t,e.state.clear&&e.setState({clear:!1})},e.handleCreate=function(){e.props.onCreate(e.text,e.state.media),e.text="",e.setState({media:null,clear:!0})},e.handleMediaUpload=function(t,n){var a={type:n,src:t};e.setState({media:a})},e.handleClearMedia=function(){e.setState({media:null})},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.clear,a=t.media;return Object(w.jsxs)("div",{className:"card create-post",children:[Object(w.jsx)("header",{className:"card__header create-post__header",children:a&&Object(w.jsx)(B,{size:"small",color:"secondary",onClick:this.handleClearMedia,children:"Clear Media"})}),Object(w.jsxs)("div",{className:"card__body create-post__body",children:[Object(w.jsx)(y,{name:"postText",placeholder:" What's on your mind?",clear:n,onTextChange:this.handleTextChange,className:"text-box create-post-text-box",type:"textarea"}),a&&Object(w.jsx)(U,{type:a.type,src:URL.createObjectURL(a.src),alt:"Post Media: "+a.type})]}),Object(w.jsxs)("div",{className:"create-post__footer",children:[Object(w.jsx)(L,{extensions:["jpg","jpeg","png","gif"],onFileChosen:function(t){return e.handleMediaUpload(t,"image")},maxFileSize:8,children:Object(w.jsx)("span",{className:"icon icon--medium",children:Object(w.jsx)(W.a,{})})}),Object(w.jsx)(L,{extensions:["mp4","mov","mpg"],onFileChosen:function(t){return e.handleMediaUpload(t,"video")},maxFileSize:8,children:Object(w.jsx)("span",{className:"icon icon--medium",children:Object(w.jsx)(W.b,{})})}),Object(w.jsx)(L,{extensions:["mp3","wav","ogg"],onFileChosen:function(t){return e.handleMediaUpload(t,"audio")},maxFileSize:8,children:Object(w.jsx)("span",{className:"icon icon--medium",children:Object(w.jsx)(J.a,{})})}),Object(w.jsx)(B,{color:"accent",size:"small",onClick:this.handleCreate,children:"Post"})]})]})}}]),n}(a.Component));K.contextType=x;var q=k(K),V=n(26),Y=n.n(V);Y.a.interceptors.response.use(null,(function(e){var t=e.response;return t&&t.status>=400&&t.status<500||j.b.error(Object(w.jsxs)("div",{children:["An unexpected error occured ",Object(w.jsx)("br",{})," ",e.message]})),Promise.reject(e)}));var H={get:Y.a.get,post:Y.a.post,put:Y.a.put,delete:Y.a.delete,patch:Y.a.patch,setJwt:function(e){Y.a.defaults.headers.common["x-auth-token"]=e}},G=Object(o.a)(Object(o.a)({},{apiUrl:"http://localhost:4000/api",loadLimit:5}),{},{apiUrl:"https://sbk-backend.herokuapp.com/api"}),Q=G.loadLimit,X=G.apiUrl+"/posts";function Z(e){var t=e.filter,n=e.filterData,a=e.maxDate,r=e.limit,s=void 0===r?Q:r;return H.get("".concat(X,"?filter=").concat(t||"","&filterData=").concat(n,"&maxDate=").concat(a||"","&limit=").concat(s))}function $(e){return H.post(X,e)}function ee(e){return H.delete("".concat(X,"/").concat(e))}function te(e){return H.patch("".concat(X,"/").concat(e),{liked:!0})}function ne(e){return H.patch("".concat(X,"/").concat(e),{liked:!1})}function ae(e){e.date=new Date(e.date)}var re=n(25),se=n(99);function ce(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t(a.result)},a.onerror=function(e){n(e)}}))}function oe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"StorageBinaryString";return new Promise((function(n,a){se.compressAsync(e,{outputEncoding:t},(function(e,t){t?a(t):n(e)}))}))}function ie(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"StorageBinaryString";return new Promise((function(n,a){se.decompressAsync(e,{inputEncoding:t},(function(e,t){t?a(t):n(e)}))}))}function le(e){return ue.apply(this,arguments)}function ue(){return(ue=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ae(t),!t.media){e.next=5;break}return e.next=4,ie(t.media.data);case 4:t.media.data=e.sent;case 5:return e.next=7,me(t.user);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){return pe.apply(this,arguments)}function pe(){return(pe=Object(u.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(re.a)(t),e.prev=1,n.s();case 3:if((a=n.n()).done){e.next=9;break}return r=a.value,e.next=7,le(r);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}function he(e){return fe.apply(this,arguments)}function fe(){return(fe=Object(u.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(re.a)(t),e.prev=1,n.s();case 3:if((a=n.n()).done){e.next=10;break}return ae(r=a.value),e.next=8,me(r.user);case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})))).apply(this,arguments)}function me(e){return je.apply(this,arguments)}function je(){return(je=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.profilePic){e.next=4;break}return e.next=3,ie(t.profilePic);case 3:t.profilePic=e.sent;case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return xe.apply(this,arguments)}function xe(){return(xe=Object(u.a)(l.a.mark((function e(t){var n,a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Object(re.a)(t),e.prev=1,n.s();case 3:if((a=n.n()).done){e.next=9;break}return r=a.value,e.next=7,me(r);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}n(64);var ve=n(31),Oe=(n(114),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(w.jsxs)("div",{className:"card",children:[Object(w.jsx)("header",{className:"card__header",children:"Card Header"}),Object(w.jsx)("div",{className:"card__body",children:"Card Body"})]})}}]),n}(a.Component)),ge=G.loadLimit,we=G.apiUrl+"/comments";function ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ge;return H.get("".concat(we,"?postId=").concat(e,"&maxDate=").concat(t||"","&limit=").concat(n))}function ye(e){return H.post(we,e)}function Ce(e){return H.delete("".concat(we,"/").concat(e))}function _e(e){return H.patch("".concat(we,"/").concat(e),{liked:!0})}function Se(e){return H.patch("".concat(we,"/").concat(e),{liked:!1})}var Pe=G.loadLimit,Ne=G.apiUrl+"/users";function De(e){return H.post(Ne,e)}function Ue(){return Fe.apply(this,arguments)}function Fe(){return(Fe=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.get("".concat(Ne,"/me"));case 2:return t=e.sent,n=t.data,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e){return H.patch("".concat(Ne,"/me"),e)}function Le(e){return H.get("".concat(Ne,"/").concat(e))}function Te(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pe;return H.get("".concat(Ne,"/").concat(e,"/following?maxDate=").concat(t||"","&limit=").concat(n))}function Ee(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pe;return H.get("".concat(Ne,"/").concat(e,"/followers?maxDate=").concat(t||"","&limit=").concat(n))}function Ae(e,t){return H.get("".concat(Ne,"/me/checkLiked/").concat(e,"?type=").concat(t))}function Ie(e){return H.get("".concat(Ne,"/me/checkFollowing/").concat(e))}var Re=n.p+"static/media/profileDefault.90dc751e.jpg";function ze(e){var t=e.src,n=e.onClick;return Object(w.jsx)("img",{src:t||Re,alt:"Profile Pic",className:"profile-pic clickable",onClick:function(){n&&n()},style:{width:"4rem",height:"4rem",borderRadius:"100%",marginRight:"10px"}})}function Be(e){var t=e.profilePicSrc,n=e.onProfileClick,r=e.username,s=e.date,c=Object(a.useContext)(x).currentUser;return Object(w.jsxs)("div",{className:"content-details",children:[Object(w.jsx)(ze,{src:t,onClick:function(){c?n():Object(j.b)("Log in to view user profiles")}}),Object(w.jsxs)("span",{className:"inline-block user-date",children:[Object(w.jsx)("span",{className:"username",children:r})," ",Object(w.jsx)("br",{}),Object(w.jsx)("span",{className:"date",children:s.toDateString()})]})]})}var We=n(67),Je=(n(115),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];return(e=t.call.apply(t,[this].concat(s))).state={showOptions:!1},e.dropdown=r.a.createRef(),e.handleOutsideClick=function(t){e.dropdown.current&&!e.dropdown.current.contains(t.target)&&e.setState({showOptions:!1})},e.handleDropdown=function(){var t=e.state.showOptions;t=!t,e.setState({showOptions:t})},e.handleOption=function(t){e.setState({showOptions:!1}),e.props.onOptionSelected(t)},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleOutsideClick)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleOutsideClick)}},{key:"render",value:function(){var e=this,t=this.props.options,n=this.state.showOptions;return Object(w.jsxs)("div",{className:"dropdown",ref:this.dropdown,children:[Object(w.jsx)("div",{className:"dropdown__content".concat(n?" show":""),children:t.map((function(t){return Object(w.jsx)(B,{styles:["block","corner"],onClick:function(){return e.handleOption(t)},children:t},t)}))}),Object(w.jsx)(We.a,{onClick:this.handleDropdown,className:"clickable"})]})}}]),n}(a.Component)),Ke=n(43),qe=n.n(Ke);function Ve(e){var t=e.children,n=e.count,a=e.onClick;return Object(w.jsxs)("span",{className:"icon-count",style:{display:"flex"},children:[Object(w.jsx)("span",{className:"icon icon--small ".concat(a?"clickable":""),onClick:a,children:t}),Object(w.jsxs)("span",{style:{marginLeft:"5px"},children:[n?Ye(n):null," "]})]})}function Ye(e){return e>=1e5?qe()(e).format("0a").replace(".0",""):qe()(e).format("0.0a").replace(".0","")}function He(e){var t=e.initialLike,n=e.onLike,r=Object(a.useState)(!1),s=Object(ve.a)(r,2),c=s[0],o=s[1];Object(a.useEffect)((function(){o(t)}),[t]);var i=c?Object(w.jsx)(O.e,{}):Object(w.jsx)(O.d,{});return Object(w.jsx)("span",{className:"icon clickable",onClick:function(){o(!c),n(!c)},children:i})}var Ge=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={date:new Date,text:"",user:{}},e.handleLike=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.context.currentUser){t.next=3;break}return Object(j.b)("Log in to save liked content"),t.abrupt("return");case 3:if(t.prev=3,a=e.state._id,!n){t.next=11;break}return t.next=8,_e(a);case 8:t.t0=t.sent,t.next=14;break;case 11:return t.next=13,Se(a);case 13:t.t0=t.sent;case 14:r=t.t0,s=r.data,c=s.likes,e.setState({likes:c}),t.next=23;break;case 20:t.prev=20,t.t1=t.catch(3),t.t1.response&&(400===(o=t.t1.response.status)?console.log("Error liking comment: ".concat(t.t1.response.data)):404===o&&j.b.error("Comment not found. Refresh to get latest content"));case 23:case"end":return t.stop()}}),t,null,[[3,20]])})));return function(e){return t.apply(this,arguments)}}(),e.handleOptionSelected=function(t){var n=e.props,a=n.onProfileClick,r=n.onDelete,s=n.onFollow,c=e.state,o=c.user,i=c._id;"Profile"===t?a(o._id):"Follow"===t||"Unfollow"===t?s(o._id):"Delete"===t&&r(i)},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.populateState()}},{key:"populateState",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,r,s,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.comment,n=t._id,a=t.user,r=t.date,s=t.text,c=t.likes,!this.context.currentUser){e.next=5;break}return e.next=4,Ae(n,"comment");case 4:o=e.sent.data;case 5:this.setState({_id:n,user:a,date:r,text:s,likes:c,initialLike:o});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.text,n=e.user,a=e.likes,r=e.date,s=e.initialLike,c=this.props,o=c.onProfileClick,i=c.following,l=c.optionMenu,u=c.hideOptions,d=i[n._id],p=this.context.currentUser,h=l||["Profile"];return l||u||p&&(p._id===n._id?h.push("Delete"):h.push(d?"Unfollow":"Follow")),Object(w.jsxs)("div",{className:"card comment",children:[Object(w.jsxs)("header",{className:"card__header post__header",children:[Object(w.jsx)(Be,{profilePicSrc:n.profilePic,onProfileClick:function(){return o(n._id)},username:n.username,date:r}),!u&&Object(w.jsx)(Je,{options:h,onOptionSelected:this.handleOptionSelected})]}),Object(w.jsxs)("div",{className:"card__body comment__body",children:[Object(w.jsx)("p",{children:t}),Object(w.jsx)("div",{className:"comment__details",children:Object(w.jsx)(Ve,{count:a,children:Object(w.jsx)(He,{onLike:this.handleLike,initialLike:s})})})]})]})}}]),n}(Oe);Ge.contextType=x;var Qe=Ge,Xe=function(e){var t=e.comments,n=e.onDelete,a=e.onProfileClick,r=e.onFollow,s=e.loadMore,c=e.onLoadMore,o=e.following,i=e.optionMenu,l=e.hideOptions;return Object(w.jsxs)("div",{className:"comments",children:[t.map((function(e){return Object(w.jsx)(Qe,{comment:e,onDelete:n,onProfileClick:a,onFollow:r,following:o,hideOptions:l,optionMenu:i},e._id)})),s&&Object(w.jsx)("div",{className:"load-more-container",children:Object(w.jsx)(B,{color:"secondary",size:"small",onClick:c,children:"Load More"})})]})},Ze=n(38),$e=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).text="",e.state={},e.handleTextChange=function(t){e.text=t,e.state.clear&&e.setState({clear:!1})},e.handleCreate=function(){e.props.onCreate(e.text),e.text="",e.setState({clear:!0})},e}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props.alert,t=this.state.clear;return Object(w.jsxs)("div",{className:"create-comment",children:[Object(w.jsx)(y,{name:"commentText",placeholder:" Comment on this post...",className:"text-box create-comment-text-box",onTextChange:this.handleTextChange,clear:t,type:"textarea",alert:e}),Object(w.jsx)(B,{color:"accent",size:"small",onClick:this.handleCreate,children:"Comment"})]})}}]),n}(a.Component),et=G.loadLimit,tt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={user:{},date:new Date,comments:[]},e.handleDeleteComment=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.state,r=a._id,s=a.numberOfComments,c=a.comments,t.next=4,Ce(n);case 4:return t.next=6,ke(r,c[c.length-1].date,1);case 6:return o=t.sent,i=o.data,t.next=10,he(i);case 10:u=c.filter((function(e){return e._id!==n})).concat(i),e.setState({comments:u,numberOfComments:s-1,loadMore:0!==i.length}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),t.t0.response&&(401===(d=t.t0.response.status)?j.b.warning("Can only delete your own posts/comments"):404===d&&j.b.error("Comment not fond. Refresh to get latest content"));case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),e.handleCreateComment=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.context.currentUser){t.next=4;break}return Object(j.b)("Log in to comment"),t.abrupt("return");case 4:if(n.trim()){t.next=7;break}return e.setState({alert:{type:"secondary",message:"Comment can't be empty"}}),t.abrupt("return");case 7:if(!(n.length>3e3)){t.next=10;break}return e.setState({alert:{type:"secondary",message:"Text can be at most 3,000 characters"}}),t.abrupt("return");case 10:return t.prev=10,r=e.state,s=r._id,c=r.numberOfComments,o={postId:s,text:n},t.next=15,ye(o);case 15:i=t.sent,ae(u=i.data),u.user.profilePic=a.profilePic,(d=Object(v.a)(e.state.comments)).unshift(u),e.setState({comments:d,alert:null,numberOfComments:c+1}),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(10),j.b.error("Some went wrong commenting");case 27:case"end":return t.stop()}}),t,null,[[10,24]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLike=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.context.currentUser){t.next=3;break}return Object(j.b)("Log in to save liked content"),t.abrupt("return");case 3:if(t.prev=3,a=e.state._id,!n){t.next=11;break}return t.next=8,te(a);case 8:t.t0=t.sent,t.next=14;break;case 11:return t.next=13,ne(a);case 13:t.t0=t.sent;case 14:r=t.t0,s=r.data,c=s.likes,e.props.onLike&&e.props.onLike(a),e.setState({likes:c}),t.next=24;break;case 21:t.prev=21,t.t1=t.catch(3),t.t1.response&&(400===(o=t.t1.response.status)?console.log("Error liking post: ".concat(t.t1.response.data)):404===o&&j.b.error("Post not found. Refresh to get latest content"));case 24:case"end":return t.stop()}}),t,null,[[3,21]])})));return function(e){return t.apply(this,arguments)}}(),e.handleOptionSelected=function(t){var n=e.props,a=n.onProfileClick,r=n.onDelete,s=n.onFollow,c=e.state,o=c.user,i=c._id;"Profile"===t?a(o._id):"Follow"===t||"Unfollow"===t?s(o._id):"Delete"===t&&r(i)},e.handleLoadMore=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n._id,r=n.comments,t.next=3,ke(a,r[r.length-1].date);case 3:return s=t.sent,c=s.data,t.next=7,he(c);case 7:o=r.concat(c),e.setState({comments:o,loadMore:c.length>=et});case 9:case"end":return t.stop()}}),t)}))),e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.populateState()}},{key:"populateState",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,r,s,c,o,i,u,d,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.post,n=t._id,a=t.user,r=t.date,s=t.text,c=t.media,o=t.comments,i=t.numberOfComments,u=t.likes,d=(o||[]).length>=et,!this.context.currentUser){e.next=7;break}return e.next=6,Ae(n,"post");case 6:p=e.sent.data;case 7:this.setState({_id:n,user:a,date:r||new Date,text:s,media:c,comments:o||[],numberOfComments:i,likes:u,loadMore:d,initialLike:p});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e._id,n=e.text,a=e.media,s=e.user,c=e.date,o=e.numberOfComments,i=e.comments,l=e.likes,u=e.initialLike,d=e.loadMore,p=e.alert,h=this.props,f=h.showComments,m=h.onPostClick,j=h.onProfileClick,b=h.following,x=h.onFollow,v=h.optionMenu,O=h.hideOptions,g=b[s._id],k=this.context.currentUser,y=v||["Profile"];return v||O||k&&(k._id===s._id?y.push("Delete"):y.push(g?"Unfollow":"Follow")),Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsxs)("div",{className:"card post",children:[Object(w.jsxs)("header",{className:"card__header post__header",children:[Object(w.jsx)(Be,{profilePicSrc:s.profilePic,onProfileClick:function(){return j(s._id)},username:s.username,date:c}),!O&&Object(w.jsx)(Je,{options:y,onOptionSelected:this.handleOptionSelected})]}),Object(w.jsxs)("div",{className:"card__body post__body",children:[n&&Object(w.jsx)("p",{children:n}),a&&Object(w.jsx)(U,{type:a.mediaType,src:a.data,alt:"Post media: "+a.mediaType}),Object(w.jsxs)("div",{className:"post__details",children:[Object(w.jsx)(Ve,{count:l,children:Object(w.jsx)(He,{initialLike:u,onLike:this.handleLike})}),Object(w.jsx)(Ve,{count:o,onClick:m&&function(){return m(t)},children:Object(w.jsx)(Ze.a,{})})]})]})]}),f&&Object(w.jsxs)("div",{className:"comments-container",children:[Object(w.jsx)($e,{onCreate:this.handleCreateComment,alert:p}),Object(w.jsx)(Xe,{comments:i,onDelete:this.handleDeleteComment,onProfileClick:j,onFollow:function(e){return x(e)},onLoadMore:this.handleLoadMore,loadMore:d,following:b,hideOptions:!k})]})]})}}]),n}(Oe);tt.contextType=x;var nt=tt;function at(e){return rt.apply(this,arguments)}function rt(){return(rt=Object(u.a)(l.a.mark((function e(t){var n,a,r,s,c,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n={},a=Object(re.a)(t),e.prev=2,a.s();case 4:if((r=a.n()).done){e.next=15;break}if(s=r.value,(c=s.user._id)in n){e.next=13;break}return e.next=10,Ie(c);case 10:o=e.sent,i=o.data,n[c]=i;case 13:e.next=4;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(2),a.e(e.t0);case 20:return e.prev=20,a.f(),e.finish(20);case 23:return e.abrupt("return",n);case 24:case"end":return e.stop()}}),e,null,[[2,17,20,23]])})))).apply(this,arguments)}var st=function(e){var t=e.posts,n=e.onFollow,r=e.onLike,s=e.onPostClick,c=e.onProfileClick,i=e.onDelete,d=e.onLoadMore,p=e.loadMore,h=e.showComments,f=e.optionMenu,m=e.hideOptions,j=Object(a.useState)({}),b=Object(ve.a)(j,2),v=b[0],O=b[1],g=Object(a.useContext)(x).currentUser;Object(a.useEffect)((function(){function e(){return(e=Object(u.a)(l.a.mark((function e(){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,at(t);case 2:if(n=e.sent,!h){e.next=10;break}return e.t0=o.a,e.t1=Object(o.a)({},n),e.next=8,at(t[0].comments);case 8:e.t2=e.sent,n=(0,e.t0)(e.t1,e.t2);case 10:O(n);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}g&&function(){e.apply(this,arguments)}()}),[t,h,g]);var k=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(o.a)({},v),a=v[t],e.next=4,Me({following:{id:t,follow:!a}});case 4:a?delete n[t]:n[t]=1,O(n);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{className:"posts",children:[t.map((function(e){return Object(w.jsx)(nt,{post:e,onPostClick:s,onProfileClick:c,onDelete:i,onFollow:function(e){k(e),n&&n(e)},onLike:r,following:v,showComments:h,optionMenu:f,hideOptions:m},e._id)})),p&&Object(w.jsx)("div",{className:"load-more-container",children:Object(w.jsx)(B,{color:"secondary",size:"small",onClick:d,children:"Load More"})})]})},ct=G.loadLimit,ot=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={posts:null,emptyPost:!1},e.relativeDates=["Today","Yesterday","Last 7 Days","Last 30 Days"],e.filterMap={username:"Username",likedPosts:"Liked Posts",following:"Following",daysAgo:"Date (Day)",dateRange:"Date Range"},e.resize=function(){var t=window.innerWidth<1e3;e.state.mobile!==t&&e.setState({mobile:t})},e.populatePosts=Object(u.a)(l.a.mark((function t(){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z({});case 3:return n=t.sent,a=n.data,t.next=7,de(a);case 7:e.setState({posts:a,loadMore:a.length>=ct}),t.next=12;break;case 10:t.prev=10,t.t0=t.catch(0);case 12:case"end":return t.stop()}}),t,null,[[0,10]])}))),e.handleLoadMore=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c,o,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.filter,r=n.filterData,s=n.posts,t.next=3,Z({filter:a,filterData:r,maxDate:s[s.length-1].date});case 3:return c=t.sent,o=c.data,t.next=7,de(o);case 7:i=s.concat(o),e.setState({posts:i,loadMore:o.length>=ct});case 9:case"end":return t.stop()}}),t)}))),e.handleLike=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("likedPosts"===e.state.filter){t.next=2;break}return t.abrupt("return");case 2:return a=e.state,r=a.filter,s=a.filterData,c=a.posts,t.next=5,Z({filter:r,filterData:s,maxDate:c[c.length-1].date,limit:1});case 5:return o=t.sent,i=o.data,t.next=9,de(i);case 9:u=c.filter((function(e){return e._id!==n})).concat(i),e.setState({posts:u,loadMore:0!==i.length});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleFollow=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u,d,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("following"===e.state.filter){t.next=2;break}return t.abrupt("return");case 2:return a=e.state,r=a.filter,s=a.filterData,c=a.posts,o=c.length,i=c.filter((function(e){return e.user._id!==n})),t.next=7,Z({filter:r,filterData:s,maxDate:c[c.length-1].date,limit:o-i.length});case 7:return u=t.sent,d=u.data,t.next=11,de(d);case 11:p=i.concat(d),e.setState({posts:p,loadMore:0!==d.length});case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleDelete=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.state,r=a.filter,s=a.filterData,c=a.posts,t.next=4,ee(n);case 4:return t.next=6,Z({filter:r,filterData:s,maxDate:c[c.length-1].date,limit:1});case 6:return o=t.sent,i=o.data,t.next=10,de(i);case 10:u=c.filter((function(e){return e._id!==n})).concat(i),e.setState({posts:u,loadMore:0!==i.length}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),t.t0.response&&(401===(d=t.t0.response.status)?j.b.warn("You can only delete your own posts/comments"):404===d&&j.b.error("Post not found. Refresh to get latest content"));case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),e.handleCreate=function(){var t=Object(u.a)(l.a.mark((function t(n,a){var r,s,c,o,i,u,d;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.context.currentUser){t.next=4;break}return Object(j.b)("Log in to post"),t.abrupt("return");case 4:if(n.trim()||a){t.next=7;break}return e.state.emptyPost||e.setState({alert:{type:"secondary",message:"Post can't be empty"}}),t.abrupt("return");case 7:if(!(n.length>3e3)){t.next=10;break}return e.setState({alert:{type:"secondary",message:"Text can be at most 3,000 characters"}}),t.abrupt("return");case 10:if(s={text:n},!a){t.next=19;break}return t.next=14,ce(a.src);case 14:return c=t.sent,t.next=17,oe(c);case 17:o=t.sent,s.media={mediaType:a.type,data:o};case 19:return t.prev=19,t.next=22,$(s);case 22:i=t.sent,ae(u=i.data),a&&(u.media.data=c),u.user.profilePic=r.profilePic,(d=Object(v.a)(e.state.posts)).unshift(u),e.setState({posts:d,alert:null}),t.next=35;break;case 32:t.prev=32,t.t0=t.catch(19),t.t0.response&&400===t.t0.response.status&&j.b.error("Something went wrong creating post");case 35:case"end":return t.stop()}}),t,null,[[19,32]])})));return function(e,n){return t.apply(this,arguments)}}(),e.handleSearchByUsername=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=n.trim().toLowerCase(),r=a?"username":void 0,t.next=4,Z({filter:r,filterData:a});case 4:return s=t.sent,c=s.data,t.next=8,de(c);case 8:e.setState({posts:c,filter:r,filterData:a,loadMore:c.length>=ct,relativeDate:null});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handlePostType=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.context.currentUser._id,"Liked Posts"===n?a="likedPosts":"Following"===n&&(a="following"),t.next=4,Z({filter:a,filterData:r});case 4:return s=t.sent,c=s.data,t.next=8,de(c);case 8:e.setState({posts:c,filter:a,filterData:r,loadMore:c.length>=ct,relativeDate:null});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleDateSelected=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="daysAgo","Today"===n?a=0:"Yesterday"===n?a=1:n.match(/Last \d+ Days/i)&&(a=n.split(" ")[1]),t.next=4,Z({filter:r,filterData:a});case 4:return s=t.sent,c=s.data,t.next=8,de(c);case 8:e.setState({posts:c,filter:r,filterData:a,loadMore:c.length>=ct,relativeDate:n});case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleDateRange=function(){var t=Object(u.a)(l.a.mark((function t(n,a){var r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r="dateRange",s=n+","+a,t.next=4,Z({filter:r,filterData:s});case 4:return c=t.sent,o=c.data,t.next=8,de(o);case 8:e.setState({posts:o,filter:r,filterData:s,loadMore:o.length>=ct,relativeDate:null});case 9:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.handlePostClick=function(t){e.props.history.push("/posts/".concat(t))},e.handleProfileClick=function(t){e.props.history.push("/profile/".concat(t))},e.handleShowSearch=function(){e.setState({showSearch:!e.state.showSearch})},e.handleClearFilter=Object(u.a)(l.a.mark((function t(){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Z({});case 2:return n=t.sent,a=n.data,t.next=6,de(a);case 6:e.setState({posts:a,filter:null,filterData:null,loadMore:a.length>=ct,relativeDate:null});case 7:case"end":return t.stop()}}),t)}))),e.clearFilterComponent=function(t){return Object(w.jsxs)("div",{children:[Object(w.jsx)("span",{className:"clickable",onClick:function(){return e.handleClearFilter()},children:"Clear Filter:"}),Object(w.jsx)("span",{style:{color:"var(--color-accent)",marginLeft:"5px"},children:e.filterMap[t]})]})},e.filterComponent=function(t){return Object(w.jsx)("span",{className:"clickable",onClick:e.handleShowSearch,children:t})},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.resize),this.resize(),this.populatePosts()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.resize)}},{key:"render",value:function(){var e=this.state,t=e.posts,n=e.mobile,a=e.showSearch,s=e.loadMore,c=e.filter,o=e.relativeDate,i=e.alert,l=this.context.currentUser;return t?Object(w.jsxs)("div",{className:"page posts-page",children:[n&&Object(w.jsx)("div",{style:{display:"flex",width:"100%",maxWidth:"500px",justifyContent:a?"flex-end":c?"space-between":"flex-end",padding:"10px 20px"},children:a?this.filterComponent("See results"):Object(w.jsxs)(r.a.Fragment,{children:[c&&this.clearFilterComponent(c),this.filterComponent("Filter")]})}),Object(w.jsx)("div",{className:"post-search-container "+(n?a?"animate__animated animate__fadeIn":"hide":""),children:Object(w.jsx)(D,{searchByUsername:this.handleSearchByUsername,dates:this.relativeDates,selectedDate:o,onDateSelected:this.handleDateSelected,onDateRange:this.handleDateRange,onPostType:this.handlePostType})}),Object(w.jsxs)("div",{className:"posts-container "+(n?a?"hide":"animate__animated animate__fadeIn":""),children:[!n&&c&&this.clearFilterComponent(c),!c&&Object(w.jsx)(q,{onCreate:this.handleCreate,alert:i}),t.length?Object(w.jsx)(st,{posts:t,onPostClick:this.handlePostClick,onProfileClick:this.handleProfileClick,onDelete:this.handleDelete,onLoadMore:this.handleLoadMore,loadMore:s,onLike:this.handleLike,onFollow:this.handleFollow,hideOptions:!l}):Object(w.jsx)("p",{style:{textAlign:"center"},children:"No posts found"})]})]}):Object(w.jsx)("p",{style:{textAlign:"center",paddingTop:"calc(var(--nav-height) * 2)"},children:"Loading posts..."})}}]),n}(a.Component);ot.contextType=x;var it=ot;function lt(){return Object(w.jsx)("h2",{className:"center",style:{padding:10},children:"Unable to find the page you're looking for"})}var ut=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={post:null},e.handleDelete=function(){var t=Object(u.a)(l.a.mark((function t(n){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee(n);case 3:e.props.history.replace("/"),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),t.t0.response&&(401===(a=t.t0.response.status)?j.b.warn("You can only delete your own posts/comments"):404===a&&j.b.error("Post not found. Try refresshing"));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e){return t.apply(this,arguments)}}(),e.handleProfileClick=function(t){e.props.history.push("/profile/".concat(t))},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.setPost()}},{key:"setPost",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=this.props.match.params.id,e.next=4,c=t,H.get("".concat(X,"/").concat(c));case 4:return n=e.sent,a=n.data,e.next=8,ke(t);case 8:return r=e.sent,s=r.data,a.comments=s,e.next=13,le(a);case 13:return e.next=15,he(a.comments);case 15:this.setState({post:a}),e.next=21;break;case 18:e.prev=18,e.t0=e.catch(0),e.t0.response&&404===e.t0.response.status&&this.props.history.replace("/not-found");case 21:case"end":return e.stop()}var c}),e,this,[[0,18]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.post,t=this.context.currentUser;return e?Object(w.jsx)("div",{className:"page post-page",children:Object(w.jsx)("div",{className:"posts-container",children:Object(w.jsx)(st,{posts:[e],showComments:!0,onProfileClick:this.handleProfileClick,onDelete:this.handleDelete,hideOptions:!t})})}):null}}]),n}(a.Component);ut.contextType=x;var dt=ut,pt=n(12),ht=n.n(pt),ft=n(19),mt=n.n(ft),jt=n(35);function bt(e,t){return Object(w.jsx)("div",{className:"alert alert--"+e,children:t})}var xt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.name,n=e.label,a=e.onChange,r=e.alert,s=e.inputType,c=Object(g.a)(e,["name","label","onChange","alert","inputType"]);return Object(w.jsxs)("div",{className:"form__group",children:[Object(w.jsx)("label",{htmlFor:t,className:"label",children:n}),"textarea"===s?Object(w.jsx)("textarea",Object(o.a)(Object(o.a)({},c),{},{id:t,className:"text-box",name:t,onChange:function(e){return a(e)}})):Object(o.a)({},"password"===c.type?Object(w.jsx)(vt,Object(o.a)(Object(o.a)({},c),{},{name:t,onChange:a})):Object(w.jsx)("input",Object(o.a)(Object(o.a)({},c),{},{id:t,className:"text-box",name:t,onChange:function(e){return a(e)}}))),r&&bt(r.type,r.message)]})}}]),n}(a.Component),vt=function(e){var t=e.name,n=e.onChange,r=(e.type,Object(g.a)(e,["name","onChange","type"])),s=Object(a.useState)(!1),c=Object(ve.a)(s,2),i=c[0],l=c[1];return Object(w.jsxs)("div",{className:"input-group",children:[Object(w.jsx)("input",Object(o.a)(Object(o.a)({},r),{},{id:t,type:i?"text":"password",className:"text-box",name:t,onChange:function(e){return n(e)}})),Object(w.jsx)("span",{className:"icon icon--small clickable",onClick:function(){return l(!i)},children:i?Object(w.jsx)(O.b,{}):Object(w.jsx)(O.c,{})})]})},Ot=xt,gt=(n(116),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={errors:{},data:{}},e.data={},e.renderButton=function(e){return Object(w.jsx)(B,{styles:["rounded","block"],color:"primary",children:e})},e.renderInput=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=e.state.errors,s=r[t]?{type:"primary",message:r[t]}:null;return Object(w.jsx)(Ot,Object(o.a)(Object(o.a)({},a),{},{name:t,label:n,onChange:e.handleChange,className:"text-box",alert:s}))},e.validate=function(){var t=ht.a.validate(e.data,e.schema).error;if(!t)return null;var n,a={},r=Object(re.a)(t.details);try{for(r.s();!(n=r.n()).done;){var s=n.value;a[s.path[0]]=s.message}}catch(c){r.e(c)}finally{r.f()}return a},e.handleSubmit=function(t){t.preventDefault();var n=e.validate();e.setState({errors:n||{}}),n||e.doSubmit()},e.doSubmit=function(){},e.validateProperty=function(t){var n=t.name,a=t.value,r=Object(jt.a)({},n,a),s=Object(jt.a)({},n,e.schema[n]),c=ht.a.validate(r,s).error;return c?c.details[0].message:null},e.handleChange=function(t){var n=t.currentTarget;e.data[n.name]=n.value},e}return n}(a.Component)),wt="loginToken",kt=G.apiUrl+"/auth";function yt(){return localStorage.getItem(wt)}function Ct(){return(Ct=Object(u.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H.post(kt,{email:t,password:n});case 2:a=e.sent,r=a.data,localStorage.setItem(wt,r),H.setJwt(yt());case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}H.setJwt(yt());var _t={login:function(e,t){return Ct.apply(this,arguments)},logout:function(){localStorage.removeItem(wt)},hasCurrentUser:function(){return null!==localStorage.getItem(wt)},loginWithJwt:function(e){localStorage.setItem(wt,e),H.setJwt(yt())},getJwt:yt},St=n.p+"static/media/sbk_image.42ab24f7.svg",Pt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).data={email:"",password:""},e.state={errors:{},alert:null},e.schema={email:ht.a.string().email().required().label("Email"),password:ht.a.string().min(8).required().label("Password")},e.doSubmit=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.data,a=n.email,r=n.password,t.next=4,_t.login(a,r);case 4:return t.next=6,e.context.onLogin();case 6:s=e.props.location.state,window.location=s?s.from.pathname:"/",t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),t.t0.response&&400===t.t0.response.status&&(c=bt("primary",t.t0.response.data),e.setState({alert:c}));case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),e}return Object(p.a)(n,[{key:"render",value:function(){if(_t.hasCurrentUser())return Object(w.jsx)(m.a,{to:"/"});var e=this.state,t=e.alert,n=e.errors;return Object(w.jsxs)("div",{className:"page login-page page-form",children:[Object(w.jsx)("img",{src:St,alt:""}),Object(w.jsxs)("form",{className:"form",onSubmit:this.handleSubmit,children:[Object(w.jsx)("h2",{children:"Login"}),mt.a.isEmpty(n)&&t,this.renderInput("email","Email",{autoFocus:!0}),this.renderInput("password","Password",{type:"password"}),this.renderButton("Login")]})]})}}]),n}(gt);Pt.contextType=x;var Nt=Pt,Dt=function(e){var t=e.component,n=e.render,a=Object(g.a)(e,["component","render"]);return Object(w.jsx)(m.b,Object(o.a)(Object(o.a)({},a),{},{render:function(e){return _t.hasCurrentUser()?t?Object(w.jsx)(t,Object(o.a)({},e)):n(e):Object(w.jsx)(m.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},Ut=n(14),Ft=(n(124),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.context.currentUser;return Object(w.jsxs)("nav",{className:"navbar",children:[Object(w.jsxs)(Ut.b,{className:"navbar__brand",to:"/posts",children:[Object(w.jsx)("span",{className:"icon",children:Object(w.jsx)(Ze.b,{})}),"SBKonnect"]}),Object(w.jsxs)("ul",{className:"list list-inline nav__items",children:[_t.hasCurrentUser()?Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(Ut.b,{className:"list__item nav__item",to:"/profile/".concat(e._id),children:"Profile"}),Object(w.jsx)(Ut.b,{className:"list__item nav__item",to:"/logout",children:"Logout"})]}):Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(Ut.b,{className:"list__item nav__item",to:"/register",children:"Register"}),Object(w.jsx)(Ut.b,{className:"list__item nav__item",to:"/login",children:"Login"})]}),!_t.hasCurrentUser()&&Object(w.jsx)(Ut.b,{className:"list__item nav__item",to:"/posts",children:"Posts"})]})]})}}]),n}(a.Component));Ft.contextType=x;var Mt=Ft,Lt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"componentDidMount",value:function(){_t.logout(),window.location="/login"}},{key:"render",value:function(){return null}}]),n}(a.Component),Tt=n(69),Et=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.onFollow,a=e.isFollowing,r=this.context.currentUser._id===t._id;return Object(w.jsxs)("div",{className:"profile-details",children:[Object(w.jsxs)("div",{className:"content-details",children:[Object(w.jsx)(ze,{src:t.profilePic}),Object(w.jsxs)("span",{className:"username",children:[t.username+(r?" (Me)":"")," "]})]}),r?Object(w.jsx)(Ut.b,{to:"/profile/edit",children:Object(w.jsx)(Tt.a,{})}):Object(w.jsx)(B,{styles:["outline"],size:"small",onClick:function(){return n(t._id)},children:a?"Unfollow":"Follow"})]})}}]),n}(a.Component);Et.contextType=x;var At=Et,It=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.tabs,n=e.currentTab,a=e.onClick;return Object(w.jsx)("div",{className:"tabnav",children:t.map((function(e){return Object(w.jsx)("p",{className:"tabnav__item clickable"+(e===n?" tabnav__item--active":""),onClick:function(){return a(e)},children:e},e)}))})}}]),n}(a.Component),Rt=(n(125),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){return Object(d.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.user,n=e.onClick;return Object(w.jsxs)("div",{className:"profile-simple clickable",onClick:function(){return n(t._id)},children:[Object(w.jsx)(ze,{src:t.profilePic}),Object(w.jsx)("span",{children:t.username})]})}}]),n}(a.Component)),zt=function(e){var t=e.loadMore,n=e.onLoadMore,a=e.users,r=e.onProfileClick;return Object(w.jsxs)("div",{className:"profile-list",children:[a.map((function(e){return Object(w.jsx)(Rt,{user:e,onClick:r},e._id)})),t&&Object(w.jsx)("div",{className:"load-more-container",children:Object(w.jsx)(B,{color:"secondary",size:"small",onClick:n,children:"Load More"})})]})},Bt=G.loadLimit,Wt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentTab:"Posts",posts:null,user:null,following:null,followers:null},e.tabs=["Posts","Following","Followers"],e.handleTabChange=function(t){var n=e.state,a=n.posts,r=n.following,s=n.followers,c=e.props.match.params.id;"Posts"!==t||a?"Following"!==t||r?"Followers"!==t||s||e.setFollowers(c):e.setFollowing(c):e.setPosts(c),e.setState({currentTab:t})},e.handleDeletePost=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.state,r=a.user,s=a.posts,t.next=4,ee(n);case 4:return t.next=6,Z({filter:"userId",filterData:r._id,maxDate:s[s.length-1].date,limit:1});case 6:return c=t.sent,o=c.data,t.next=10,de(o);case 10:i=s.filter((function(e){return e._id!==n})).concat(o),e.setState({posts:i,loadMorePosts:0!==o.length}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),t.t0.response&&(401===(u=t.t0.response.status)?j.b.warn("You can only delete your own posts/comments"):404===u&&j.b.error("Post not found. Refresh to get latest content"));case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e){return t.apply(this,arguments)}}(),e.setFollowing=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Te(n);case 3:return a=t.sent,r=a.data,t.next=7,be(r);case 7:e.setState({following:r,loadMoreFollowing:r.length>=Bt}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log("Error: ",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),e.setFollowers=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ee(n);case 3:return a=t.sent,r=a.data,t.next=7,be(r);case 7:e.setState({followers:r,loadMoreFollowers:r.length>=Bt}),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),console.log("Error: ",t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})));return function(e){return t.apply(this,arguments)}}(),e.setUser=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Le(n);case 3:return a=t.sent,r=a.data,t.next=7,me(r);case 7:return t.next=9,Z({filter:"userId",filterData:n});case 9:return s=t.sent,c=s.data,t.next=13,Ie(n);case 13:return o=t.sent,i=o.data,t.next=17,de(c);case 17:e.setState({user:r,posts:c,following:null,followers:null,currentTab:"Posts",loadMorePosts:c.length>=Bt,isFollowing:i}),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.log("Error: ",t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})));return function(e){return t.apply(this,arguments)}}(),e.handleLoadMorePosts=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.posts,r=n.user,t.next=3,Z({filter:"userId",filterData:r._id,maxDate:a[a.length-1].date});case 3:return s=t.sent,c=s.data,t.next=7,de(c);case 7:o=a.concat(c),e.setState({posts:o,loadMorePosts:c.length>=Bt});case 9:case"end":return t.stop()}}),t)}))),e.handleLoadMoreFollowing=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.following,r=n.user,t.next=3,Te(r._id,a.length&&a[a.length-1].date);case 3:return s=t.sent,c=s.data,t.next=7,be(c);case 7:o=a.concat(c),e.setState({following:o,loadMoreFollowing:c.length>=Bt});case 9:case"end":return t.stop()}}),t)}))),e.handleLoadMoreFollowers=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.state,a=n.followers,r=n.user,t.next=3,Ee(r._id,a.length&&a[a.length-1].date);case 3:return s=t.sent,c=s.data,t.next=7,be(c);case 7:o=a.concat(c),e.setState({followers:o,loadMoreFollowers:c.length>=Bt});case 9:case"end":return t.stop()}}),t)}))),e.handleFollow=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r,s,c,o,i,u,d,p,h,f,m,j;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state,r=a.isFollowing,s=a.following,c=a.followers,o=a.user,i=e.context.currentUser,t.next=4,Me({following:{id:n,follow:!r}});case 4:if(!r){t.next=15;break}if(!(u=c&&c.filter((function(e){return e._id!==i._id})))){t.next=13;break}return t.next=9,Ee(o._id,c[c.length-1].date,1);case 9:h=t.sent,f=h.data,u=u.concat(f),p=0!==f.length;case 13:t.next=23;break;case 15:return t.next=17,Le(i._id);case 17:return m=t.sent,j=m.data,t.next=21,me(j);case 21:u=c&&[j].concat(Object(v.a)(c)),i._id===o._id&&(d=s&&[j].concat(Object(v.a)(s)));case 23:e.setState({isFollowing:!r,following:d,followers:u,loadMoreFollowers:p});case 24:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleProfileClick=function(t){e.props.history.push("/profile/".concat(t))},e.handlePostClick=function(t){e.props.history.push("/posts/".concat(t))},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.unlisten=this.props.history.listen((function(t,n){var a=t.pathname;if(a.startsWith("/profile")){var r=(a=t.pathname.endsWith("/")?t.pathname.substring(1,t.pathname.length):t.pathname.substring(1)).split("/");2===r.length&&"edit"!==r[1]&&e.setUser(r[1])}})),this.setUser(this.props.match.params.id)}},{key:"componentWillUnmount",value:function(){this.unlisten()}},{key:"render",value:function(){var e=this.state,t=e.user,n=e.currentTab,a=e.posts,r=e.following,s=e.followers,c=e.loadMorePosts,o=e.loadMoreFollowing,i=e.loadMoreFollowers,l=e.isFollowing,u=this.context.currentUser;return t?Object(w.jsx)("div",{className:"page profile-page",children:Object(w.jsxs)("div",{className:"profile-card",children:[Object(w.jsxs)("header",{className:"card__header profile-card__header",children:[Object(w.jsx)(At,{user:t,onFollow:this.handleFollow,isFollowing:l}),Object(w.jsx)(It,{tabs:this.tabs,currentTab:n,onClick:this.handleTabChange})]}),Object(w.jsxs)("div",{className:"card__body profile-card__body",children:["Posts"===n&&(a?Object(w.jsx)("div",{className:"posts-container animate__animated animate__fadeIn",children:Object(w.jsx)(st,{posts:a,onProfileClick:this.handleProfileClick,onPostClick:this.handlePostClick,onDelete:this.handleDeletePost,onLoadMore:this.handleLoadMorePosts,loadMore:c,optionMenu:u._id===t._id&&["Delete"],hideOptions:u._id!==t._id})}):Object(w.jsx)("p",{children:"Loading posts..."})),"Following"===n&&(r?Object(w.jsx)("div",{className:"following-container animate__animated animate__fadeIn",children:Object(w.jsx)(zt,{users:r,onProfileClick:this.handleProfileClick,loadMore:o,onLoadMore:this.handleLoadMoreFollowing})}):Object(w.jsx)("p",{children:"Loading followings..."})),"Followers"===n&&(s?Object(w.jsx)("div",{className:"followers-container animate__animated animate__fadeIn",children:Object(w.jsx)(zt,{users:s,onProfileClick:this.handleProfileClick,loadMore:i,onLoadMore:this.handleLoadMoreFollowers})}):Object(w.jsx)("p",{children:"Loading followers.."}))]})]})}):null}}]),n}(a.Component);Wt.contextType=x;var Jt=Wt,Kt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={errors:{},alert:null},e.data={},e.schema={description:ht.a.string().allow("")},e.doSubmit=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.data.description,t.next=4,Me({description:n});case 4:a=t.sent,r=a.data,s=bt("accent","Description updated"),e.setState({alert:s}),e.context.updateUser("description",r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),t.t0.response&&400===t.t0.response.status&&(c=bt("primary",t.t0.response.data),e.setState({alert:c}));case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.data.description=this.context.currentUser.description}},{key:"render",value:function(){var e=this.context.currentUser.description,t=this.state,n=t.alert,a=t.errors;return Object(w.jsx)("div",{className:"page page-form",children:Object(w.jsxs)("form",{onSubmit:this.handleSubmit,className:"form",children:[Object(w.jsx)("h2",{children:"Edit Description"}),mt.a.isEmpty(a)&&n,this.renderInput("description","",{inputType:"textarea",defaultValue:e}),this.renderButton("Save")]})})}}]),n}(gt);Kt.contextType=x;var qt=Kt,Vt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={errors:{},alert:null},e.schema={username:ht.a.string()},e.data={},e.doSubmit=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.data.username,t.next=4,Me({username:n});case 4:a=t.sent,r=a.data,s=bt("accent","Username updated"),e.setState({alert:s}),e.context.updateUser("username",r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),t.t0.response&&400===t.t0.response.status&&(c={username:t.t0.response.data},e.setState({errors:c}));case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.data.username=this.context.currentUser.username}},{key:"render",value:function(){var e=this.context.currentUser.username,t=this.state,n=t.alert,a=t.errors;return Object(w.jsx)("div",{className:"page page-form",children:Object(w.jsxs)("form",{onSubmit:this.handleSubmit,className:"form",children:[Object(w.jsx)("h2",{children:"Edit Username"}),mt.a.isEmpty(a)&&n,this.renderInput("username","",{defaultValue:e}),this.renderButton("Save")]})})}}]),n}(gt);Vt.contextType=x;var Yt=Vt,Ht=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={errors:{},alert:null},e.data={},e.schema={email:ht.a.string().email()},e.doSubmit=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=e.data.email,t.next=4,Me({email:n});case 4:a=t.sent,r=a.data,s=bt("accent","Email updated"),e.setState({alert:s}),e.context.updateUser("email",r),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),t.t0.response&&400===t.t0.response.status&&(c={email:t.t0.response.data},e.setState({errors:c}));case 14:case"end":return t.stop()}}),t,null,[[0,11]])}))),e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.data.email=this.context.currentUser.email}},{key:"render",value:function(){var e=this.context.currentUser.email,t=this.state,n=t.errors,a=t.alert;return Object(w.jsx)("div",{className:"page page-form",children:Object(w.jsxs)("form",{onSubmit:this.handleSubmit,className:"form",children:[Object(w.jsx)("h2",{children:"Edit Email"}),mt.a.isEmpty(n)&&a,this.renderInput("email","",{defaultValue:e}),this.renderButton("Save")]})})}}]),n}(gt);Ht.contextType=x;var Gt=Ht,Qt=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={errors:{},alert:null},e.schema={password:ht.a.string().min(8),confirmPassword:ht.a.string()},e.data={password:"",confirmPassword:""},e.doSubmit=Object(u.a)(l.a.mark((function t(){var n,a,r,s,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.data,a=n.password,n.confirmPassword===a){t.next=5;break}return r={confirmPassword:"Passwords don't match"},e.setState({errors:r}),t.abrupt("return");case 5:return t.prev=5,t.next=8,Me({password:a});case 8:s=bt("accent","Password updated"),e.setState({alert:s}),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(5),t.t0.response&&400===t.t0.response.status&&(c={password:t.t0.response.data},e.setState({errors:c}));case 15:case"end":return t.stop()}}),t,null,[[5,12]])}))),e}return Object(p.a)(n,[{key:"render",value:function(){var e=this.state,t=e.alert,n=e.errors;return Object(w.jsx)("div",{className:"page page-form",children:Object(w.jsxs)("form",{onSubmit:this.handleSubmit,className:"form",children:[Object(w.jsx)("h2",{children:"Edit Password"}),mt.a.isEmpty(n)&&t,this.renderInput("password","New Password",{type:"password"}),this.renderInput("confirmPassword","Confirm Password",{type:"password"}),this.renderButton("Save")]})})}}]),n}(gt);Qt.contextType=x;var Xt=Qt,Zt=function(e){var t=e.label,n=e.text,a=e.icon,r=Object(g.a)(e,["label","text","icon"]);return Object(w.jsxs)("div",Object(o.a)(Object(o.a)({},r),{},{children:[Object(w.jsx)("span",{className:"edit-row__label",children:t}),Object(w.jsx)("span",{className:"edit-row__text",children:n}),Object(w.jsx)("span",{className:"icon",children:a})]}))},$t=M(Zt),en=(n(126),function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).goToUpdate=function(t){e.props.history.push("/profile/edit/".concat(t))},e.handleProfilePicUpload=function(){var t=Object(u.a)(l.a.mark((function t(n){var a,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ce(n);case 3:return a=t.sent,e.context.updateUser("profilePic",a),t.next=7,oe(a);case 7:return r=t.sent,t.next=10,Me({profilePic:r});case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),t.t0.response?console.log("Error: ",t.t0.response):console.log("Error: ",t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}(),e}return Object(p.a)(n,[{key:"render",value:function(){var e=this,t=this.context.currentUser,n=t.email,a=t.username,r=t.description,s=t.profilePic,c=Object(w.jsx)(O.a,{});return Object(w.jsxs)("div",{className:"page profile-edit-page",children:[Object(w.jsx)("div",{className:"profile-edit__header",children:"My Profile"}),Object(w.jsx)($t,{label:"Photo",text:"Shown on your posts and comments",icon:Object(w.jsx)(ze,{src:s,onClick:function(){}}),className:"edit-row profile-edit__photo clickable",extensions:["jpg","jpeg","gif","png"],maxFileSize:2,onFileChosen:this.handleProfilePicUpload}),Object(w.jsx)(Zt,{label:"Username",text:a,icon:c,className:"edit-row profile-edit__username clickable",onClick:function(){return e.goToUpdate("username")}}),Object(w.jsx)(Zt,{label:"Email",text:n,icon:c,className:"edit-row profile-edit__email clickable",onClick:function(){return e.goToUpdate("email")}}),Object(w.jsx)(Zt,{label:"Description",text:r,icon:c,className:"edit-row profile-edit__description clickable",onClick:function(){return e.goToUpdate("description")}}),Object(w.jsx)(Zt,{label:"Password",text:"Click to change",icon:c,className:"edit-row profile-edit__password clickable",onClick:function(){return e.goToUpdate("password")}})]})}}]),n}(a.Component));en.contextType=x;var tn=en,nn=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).componentDidMount=function(){return window.scrollTo(0,0)},e.componentDidUpdate=function(t){e.props.location!==t.location&&window.scrollTo(0,0)},e.render=function(){return e.props.children},e}return n}(a.PureComponent),an=Object(m.g)(nn),rn=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={errors:{},data:{},alert:null},e.data={username:"",email:"",password:""},e.schema={username:ht.a.string().min(5).max(255).required().label("Username"),email:ht.a.string().min(8).max(255).email().required().label("Email"),password:ht.a.string().min(8).max(255).required().label("Password")},e.doSubmit=Object(u.a)(l.a.mark((function t(){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,De(e.data);case 3:return n=t.sent,_t.loginWithJwt(n.headers["x-auth-token"]),t.next=7,e.context.onLogin();case 7:window.location="/",t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),t.t0.response&&400===t.t0.response.status&&(a=bt("primary",t.t0.response.data),e.setState({alert:a}));case 13:case"end":return t.stop()}}),t,null,[[0,10]])}))),e}return Object(p.a)(n,[{key:"render",value:function(){if(_t.hasCurrentUser())return Object(w.jsx)(m.a,{to:"/"});var e=this.state,t=e.alert,n=e.errors;return Object(w.jsxs)("div",{className:"page register-page page-form",children:[Object(w.jsx)("img",{src:St,alt:""}),Object(w.jsxs)("form",{onSubmit:this.handleSubmit,className:"form",children:[Object(w.jsx)("h2",{children:"Register"}),mt.a.isEmpty(n)&&t,this.renderInput("username","Username",{autoFocus:!0}),this.renderInput("email","Email"),this.renderInput("password","Password",{type:"password"}),this.renderButton("Register")]})]})}}]),n}(gt);rn.contextType=x;var sn=rn,cn=function(e){Object(h.a)(n,e);var t=Object(f.a)(n);function n(){var e;Object(d.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={currentUser:null},e.setUser=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(_t.hasCurrentUser()){t.next=2;break}return t.abrupt("return");case 2:try{e.handleLogin()}catch(n){j.b.error("Something went wrong"),_t.logout()}case 3:case"end":return t.stop()}}),t)}))),e.handleLogin=Object(u.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ue();case 2:if(!(n=t.sent).profilePic){t.next=7;break}return t.next=6,ie(n.profilePic);case 6:n.profilePic=t.sent;case 7:e.setState({currentUser:n});case 8:case"end":return t.stop()}}),t)}))),e.updateUser=function(t,n){var a=Object(o.a)({},e.state.currentUser);a[t]=n,e.setState({currentUser:a})},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){this.setUser()}},{key:"render",value:function(){return _t.hasCurrentUser()&&!this.state.currentUser?null:Object(w.jsx)(x.Provider,{value:{currentUser:this.state.currentUser,onLogin:this.handleLogin,updateUser:this.updateUser},children:Object(w.jsxs)(r.a.Fragment,{children:[Object(w.jsx)(j.a,{}),Object(w.jsx)(Mt,{}),Object(w.jsx)("main",{children:Object(w.jsx)(an,{children:Object(w.jsxs)(m.d,{children:[Object(w.jsx)(m.b,{path:"/register",component:sn,exact:!0}),Object(w.jsx)(m.b,{path:"/login",component:Nt,exact:!0}),Object(w.jsx)(m.b,{path:"/logout",component:Lt,exact:!0}),Object(w.jsx)(m.b,{path:"/posts/:id",component:dt,exact:!0}),Object(w.jsx)(m.b,{path:"/posts",component:it,exact:!0}),Object(w.jsx)(Dt,{path:"/profile/edit",component:tn,exact:!0}),Object(w.jsx)(Dt,{path:"/profile/:id",component:Jt,exact:!0}),Object(w.jsx)(Dt,{path:"/profile/edit/username",component:Yt,exact:!0}),Object(w.jsx)(Dt,{path:"/profile/edit/email",component:Gt,exact:!0}),Object(w.jsx)(Dt,{path:"/profile/edit/description",component:qt,exact:!0}),Object(w.jsx)(Dt,{path:"/profile/edit/password",component:Xt,exact:!0}),Object(w.jsx)(m.b,{path:"/not-found",component:lt}),Object(w.jsx)(m.a,{from:"/",to:_t.hasCurrentUser()?"/posts":"/login",exact:!0}),Object(w.jsx)(m.a,{to:"/not-found"})]})})}),Object(w.jsx)("footer",{})]})})}}]),n}(a.Component),on=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,128)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),a(e),r(e),s(e),c(e)}))};c.a.render(Object(w.jsx)(Ut.a,{children:Object(w.jsx)(cn,{})}),document.getElementById("root")),on()},64:function(e,t,n){},75:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){}},[[127,1,2]]]);
//# sourceMappingURL=main.c79b7039.chunk.js.map